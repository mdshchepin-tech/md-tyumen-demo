<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ –≥–æ—Å–ø–∏—Ç–∞–ª—è ‚Äî GitHub Edition (No media)</title>
  <meta name="description" content="–î–≤—É—Ö—Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ + –ö–æ–Ω—Å–∏–ª–∏—É–º (5 —ç—Ç–∞–ø–æ–≤). –ë–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ. –ì–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages."/>
  <style>
    :root{
      --brand-bg:#fffaf2;
      --brand-card:#ffffff;
      --brand-accent:#caa85a;
      --brand-accent-2:#2d2d2d;
      --brand-accent-soft:#f2e6c9;
      --brand-text:#1a1a1a;
      --ok:#2e7d32; --bad:#c62828; --info:#1565c0;
      --radius:18px; --shadow: 0 10px 30px rgba(0,0,0,0.06);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--brand-bg);color:var(--brand-text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;}
    a{color:var(--info);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    header{
      position:sticky;top:0;z-index:50;backdrop-filter:saturate(1.2) blur(6px);
      background:color-mix(in oklab, var(--brand-bg) 70%, #fff 30%);
      border-bottom:1px solid #eee
    }
    header .inner{display:flex;gap:16px;align-items:center;justify-content:space-between;max-width:980px;margin:0 auto;padding:12px 24px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:38px;height:38px;border-radius:50%;background:radial-gradient( circle at 30% 30%, #fff 0 35%, var(--brand-accent) 36% 100% );box-shadow:inset 0 0 0 2px var(--brand-accent-soft), 0 2px 12px rgba(0,0,0,.08)}
    .brand h1{font-size:18px;margin:0;font-weight:700;color:var(--brand-accent-2)}
    .actions{display:flex;gap:10px}
    .btn{appearance:none;border:none;border-radius:14px;padding:10px 14px;font-weight:600;cursor:pointer;box-shadow:var(--shadow);background:var(--brand-accent);color:#fff}
    .btn.secondary{background:var(--brand-accent-soft);color:#684f14}
    .btn.ghost{background:#fff;border:1px solid #eee;color:#333}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .card{background:var(--brand-card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
    .grid{display:grid;gap:16px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:860px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}
    .hero{display:grid;gap:22px;grid-template-columns:1.2fr .8fr;align-items:center}
    @media (max-width:980px){.hero{grid-template-columns:1fr}}
    .hero h2{margin:0;font-size:28px}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:var(--brand-accent-soft);color:#6c5519;font-weight:600;font-size:13px}
    .tile{position:relative;border:1px solid #eee;overflow:hidden;transition:transform .15s ease, box-shadow .15s ease}
    .tile:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,0,0,.08)}
    .tile .title{padding:14px 16px;font-weight:700}
    #quiz{display:none}
    .q-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .q-counter{font-weight:700}
    .progress{height:8px;background:#eee;border-radius:999px;overflow:hidden}
    .progress>span{display:block;height:100%;background:var(--brand-accent);width:0}
    .question{margin-top:8px}
    .question h3{margin:6px 0 12px 0;font-size:18px}
    .answer{display:block;border:1px solid #eee;border-radius:14px;padding:12px 12px;margin:10px 0;background:#fff;transition:border-color .12s ease, background .12s ease}
    .answer:hover{border-color:var(--brand-accent-soft);background:linear-gradient(#fff,#fff8)}
    .answer input{margin-right:10px}
    .answer .opt-label{font-weight:600}
    .hint{font-size:13px;color:#6b6b6b}
    .footer-nav{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
    .result{display:none}
    .result h3{margin:10px 0}
    .badge{display:inline-block;padding:8px 12px;border-radius:999px;background:#f5f5f5;font-weight:700}
    .badge.ok{background:#e9f6eb;color:var(--ok)}
    .badge.bad{background:#fdeaea;color:var(--bad)}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:18px;z-index:100}
    .modal .box{max-width:760px;width:100%;background:#fff;border-radius:20px;box-shadow:var(--shadow);padding:18px}
    .modal h3{margin:6px 0 8px}
    .modal .chk{display:flex;gap:10px;align-items:center;margin-top:8px}
    #consilium{display:none}
    .stage-ind{display:flex;gap:6px;margin:8px 0}
    .stage-ind span{width:10px;height:10px;border-radius:99px;background:#eee}
    .stage-ind span.on{background:var(--brand-accent)}
    .config-tip{font-size:12px;color:#666}
  </style>
</head>
<body>
  <header>
    <div class="inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞ –≥–æ—Å–ø–∏—Ç–∞–ª—è</h1>
      </div>
      <div class="actions">
        <button class="btn ghost" id="btnRules">–ü—Ä–∞–≤–∏–ª–∞</button>
        <button class="btn" id="btnStart" disabled>–ù–∞—á–∞—Ç—å</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- –õ–ï–ù–î–ò–ù–ì -->
    <section id="landing" class="grid cols-2">
      <div class="card hero">
        <div>
          <span class="pill">–ì–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages ‚Ä¢ –ë–µ–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏ –≤–∏–¥–µ–æ</span>
          <h2>–î–≤–∞ —Ä–µ–∂–∏–º–∞: –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ + ¬´–ö–æ–Ω—Å–∏–ª–∏—É–º¬ª (5 —ç—Ç–∞–ø–æ–≤)</h2>
          <p>
            –ü–æ–¥—Å—á—ë—Ç (–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞): <b>–æ–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä</b> ‚Äî 1 –±–∞–ª–ª; <b>–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π</b> ‚Äî 0,5 –∑–∞ –∫–∞–∂–¥—ã–π –≤–µ—Ä–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ 1 –±–∞–ª–ª –ø—Ä–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ.<br/>
            –ü–æ–¥—Å—á—ë—Ç (–∫–æ–Ω—Å–∏–ª–∏—É–º): <b>–∫–∞–∂–¥—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç = 1 –±–∞–ª–ª</b>; –Ω–∞ —ç—Ç–∞–ø–µ 5 –∑–∞ ¬´–≠–Ω–¥–æ–≤–∞—Å–∫—É–ª—è—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã¬ª ‚Äî <b>—Å–∫—Ä—ã—Ç—ã–π –±–æ–Ω—É—Å +2</b>.
          </p>
          <p class="config-tip">–í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –±–ª–æ–∫–µ <code>CONFIG</code> –≤–Ω–∏–∑—É —Ñ–∞–π–ª–∞.</p>
          <div class="grid cols-2">
            <button class="btn" onclick="selectMode('quiz')">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ</button>
            <button class="btn secondary" onclick="selectMode('consilium')">–û—Ç–∫—Ä—ã—Ç—å –ö–æ–Ω—Å–∏–ª–∏—É–º</button>
          </div>
        </div>
        <div class="grid cols-2">
          <div class="tile" onclick="selectSection('art_gyn')" role="button" tabindex="0">
            <div class="title">–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è</div>
          </div>
          <div class="tile" onclick="selectSection('ob')" role="button" tabindex="0">
            <div class="title">–ê–∫—É—à–µ—Ä—Å—Ç–≤–æ</div>
          </div>
        </div>
      </div>

      <div class="grid cols-1">
        <div class="card">
          <h3 style="margin:0 0 10px 0">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª</h3>
          <p>–ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º –Ω—É–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã ‚Äî –∏–Ω–∞—á–µ –∫–Ω–æ–ø–∫–∞ ¬´–ù–∞—á–∞—Ç—å¬ª –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞.</p>
        </div>
      </div>
    </section>

    <!-- –í–ò–ö–¢–û–†–ò–ù–ê -->
    <section id="quiz" class="card">
      <div class="q-nav">
        <div class="q-counter"><span id="qIndex">1</span>/<span id="qTotal">1</span></div>
        <div style="display:flex;gap:12px;align-items:center">
          <span id="sectionTitle" class="pill">‚Äî</span>
          <div class="progress" style="width:220px"><span id="progressBar"></span></div>
        </div>
      </div>

      <div class="question" id="question"></div>
      <div class="footer-nav">
        <button class="btn ghost" id="btnPrev">–ù–∞–∑–∞–¥</button>
        <button class="btn" id="btnNext">–î–∞–ª–µ–µ</button>
      </div>
    </section>

    <!-- –†–ï–ó–£–õ–¨–¢–ê–¢–´ -->
    <section id="result" class="card result">
      <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
      <p>–ù–∞–±—Ä–∞–Ω–æ –±–∞–ª–ª–æ–≤: <span class="badge" id="scoreBadge">0</span></p>
      <p id="winner" style="display:none" class="badge ok">üéâ –í—ã ‚Äî –ø–æ–±–µ–¥–∏—Ç–µ–ª—å! –ó–∞–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–∑!</p>
      <div id="review"></div>
      <div class="footer-nav">
        <button class="btn" onclick="restart()">–°—ã–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
      </div>
    </section>

    <!-- –ö–û–ù–°–ò–õ–ò–£–ú -->
    <section id="consilium" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 style="margin:0">–ö–æ–Ω—Å–∏–ª–∏—É–º: 5 —ç—Ç–∞–ø–æ–≤</h3>
        <div class="stage-ind" id="stageDots"></div>
      </div>
      <div id="stage"></div>
      <div class="footer-nav">
        <button class="btn ghost" id="btnPrevS">–ù–∞–∑–∞–¥</button>
        <button class="btn" id="btnNextS">–î–∞–ª–µ–µ</button>
      </div>
      <p class="config-tip">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ <code>CONFIG.consilium.stages</code>.</p>
    </section>
  </main>

  <!-- –ú–û–î–ê–õ: –ü–†–ê–í–ò–õ–ê -->
  <div class="modal" id="rulesModal" role="dialog" aria-modal="true">
    <div class="box">
      <h3>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h3>
      <ul>
        <li><b>2 —Ä–∞–∑–¥–µ–ª–∞</b>: ¬´–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è¬ª –∏ ¬´–ê–∫—É—à–µ—Ä—Å—Ç–≤–æ¬ª.</li>
        <li><b>–û–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä (–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞)</b>: 1 –±–∞–ª–ª –∑–∞ –≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç.</li>
        <li><b>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä (–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞)</b>: 0,5 –±–∞–ª–ª–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç; –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω—ã –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏ –Ω–µ –≤—ã–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ ‚Äî 1 –±–∞–ª–ª.</li>
        <li><b>–ö–æ–Ω—Å–∏–ª–∏—É–º</b>: –∫–∞–∂–¥—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç = 1 –±–∞–ª–ª; —Å–∫—Ä—ã—Ç—ã–π –±–æ–Ω—É—Å +2 –∑–∞ ¬´–≠–Ω–¥–æ–≤–∞—Å–∫—É–ª—è—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã¬ª –Ω–∞ —ç—Ç–∞–ø–µ 5.</li>
        <li>–ü—Ä–∏ —Å—É–º–º–µ <b>‚â• 5</b> –±–∞–ª–ª–æ–≤ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´üéâ –í—ã ‚Äî –ø–æ–±–µ–¥–∏—Ç–µ–ª—å! –ó–∞–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–∑!¬ª.</li>
      </ul>
      <label class="chk"><input type="checkbox" id="rulesAgree"> <span>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ –æ–∑–Ω–∞–∫–æ–º–∏–ª—Å—è(–∞—Å—å) —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏</span></label>
      <div class="footer-nav">
        <button class="btn" id="rulesOk">–ì–æ—Ç–æ–≤–æ</button>
        <button class="btn ghost" id="rulesClose">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // =============================
    //          –ö–û–ù–§–ò–ì
    // =============================
    const CONFIG = {
      sections: [
        {
          id: 'art_gyn',
          title: '–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è',
          questions: [
            {
              type: 'single',
              text: '–ü—Ä–∏–º–µ—Ä –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à).',
              answers: [
                { text: '–í–∞—Ä–∏–∞–Ω—Ç A', correct: true },
                { text: '–í–∞—Ä–∏–∞–Ω—Ç B', correct: false },
                { text: '–í–∞—Ä–∏–∞–Ω—Ç C', correct: false }
              ]
            },
            {
              type: 'multi',
              text: '–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –≤—ã–±–æ—Ä–æ–º (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à).',
              answers: [
                { text: '–í–∞—Ä–∏–∞–Ω—Ç 1', correct: true },
                { text: '–í–∞—Ä–∏–∞–Ω—Ç 2', correct: true },
                { text: '–í–∞—Ä–∏–∞–Ω—Ç 3', correct: false }
              ]
            }
          ]
        },
        {
          id: 'ob',
          title: '–ê–∫—É—à–µ—Ä—Å—Ç–≤–æ',
          questions: [
            {
              type: 'single',
              text: '–ü—Ä–∏–º–µ—Ä –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –ø–æ –∞–∫—É—à–µ—Ä—Å—Ç–≤—É.',
              answers: [
                { text: '–û—Ç–≤–µ—Ç 1', correct: false },
                { text: '–û—Ç–≤–µ—Ç 2', correct: true },
                { text: '–û—Ç–≤–µ—Ç 3', correct: false }
              ]
            }
          ]
        }
      ],
      consilium: {
        // –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π: 5 —ç—Ç–∞–ø–æ–≤ (–≤–∞—à –∫–µ–π—Å)
        stages: [
          {
            title: '–≠—Ç–∞–ø 1 ‚Äî –ü—Ä–µ–≥—Ä–∞–≤–∏–¥–∞—Ä–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
            body: '–ü–∞—Ü–∏–µ–Ω—Ç–∫–∞ –ê, 35 –ª–µ—Ç. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç –≤—Ç–æ—Ä—É—é –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å. –í –∞–Ω–∞–º–Ω–µ–∑–µ: –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –≠–ö–û –ø–æ –ø–æ–≤–æ–¥—É –±–µ—Å–ø–ª–æ–¥–∏—è –Ω–µ—è—Å–Ω–æ–≥–æ –≥–µ–Ω–µ–∑–∞; –ò–¶–ù ‚Äî —Å–µ—Ä–∫–ª—è–∂; –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–¥—ã –Ω–∞ 33 –Ω–µ–¥, –ü–û–ù–†–ü –≤ I –ø–µ—Ä–∏–æ–¥–µ, —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –ö–°.',
            questions: [
              {
                type: 'single',
                text: '–ö–∞–∫–æ–µ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –Ω–∞ –ø—Ä–µ–≥—Ä–∞–≤–∏–¥–∞—Ä–Ω–æ–º —ç—Ç–∞–ø–µ?',
                answers: [
                  { text: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –≥–∏—Å—Ç–µ—Ä–æ—Å–∫–æ–ø–∏—è', correct: false },
                  { text: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –ª–∞–ø–∞—Ä–æ—Å–∫–æ–ø–∏—è', correct: false },
                  { text: '–õ–∞–ø–∞—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–∫–ª—è–∂', correct: true },
                  { text: '–í–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è', correct: false }
                ]
              },
              {
                type: 'single',
                text: '–î–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:',
                answers: [
                  { text: '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤', correct: false },
                  { text: '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤', correct: false },
                  { text: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –í–†–¢: –≠–ö–û', correct: true }
                ]
              }
            ]
          },
          {
            title: '–≠—Ç–∞–ø 2 ‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏',
            body: '–ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—É–ø–∏–ª–∞ –ø–æ—Å–ª–µ –≠–ö–û. –ù–∞ 1‚Äì2 –£–ó-—Å–∫—Ä–∏–Ω–∏–Ω–≥–∞—Ö: –ø—Ä–µ–¥–ª–µ–∂–∞–Ω–∏–µ –ø–ª–∞—Ü–µ–Ω—Ç—ã, –£–ó-–ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ä–∞—Å—Ç–∞–Ω–∏—è –ø–ª–∞—Ü–µ–Ω—Ç—ã –≤ —Ä—É–±–µ—Ü –Ω–∞ –º–∞—Ç–∫–µ.',
            questions: [
              {
                type: 'single',
                text: '–ö–∞–∫–æ–π –¥–æ–ø–æ–ª–Ω—è—é—â–∏–π –º–µ—Ç–æ–¥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤—ã–±—Ä–∞—Ç—å?',
                answers: [
                  { text: '–ú–†–¢', correct: true },
                  { text: '–ö–¢–ì', correct: false },
                  { text: '–ö–¢', correct: false },
                  { text: '–õ–∞–ø–∞—Ä–æ—Å–∫–æ–ø–∏—è', correct: false }
                ]
              }
            ]
          },
          {
            title: '–≠—Ç–∞–ø 3 ‚Äî –û—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –≤ III —Ç—Ä–∏–º–µ—Å—Ç—Ä–µ',
            body: '30 –Ω–µ–¥–µ–ª—å: —Ç—è–Ω—É—â–∏–µ –±–æ–ª–∏, —Å–∫—É–¥–Ω—ã–µ –∫—Ä–æ–≤—è–Ω–∏—Å—Ç—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è. –ì–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è (III —É—Ä–æ–≤–µ–Ω—å), —Ç–æ–∫–æ–ª–∏–∑, –∫—É—Ä—Å –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –†–î–° –ø–ª–æ–¥–∞. –ü–æ—Å–ª–µ —Ç–µ—Ä–∞–ø–∏–∏ –∂–∞–ª–æ–± –Ω–µ—Ç, –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞—é—â–µ–≥–æ—Å—è –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è –Ω–µ—Ç, –ø–æ–∫–∞–∑–∞–Ω–∏–π –∫ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–º—É –ö–° –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ.',
            questions: [
              {
                type: 'single',
                text: '–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ —Ä–æ–¥–æ—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏:',
                answers: [
                  { text: '–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –†–î–° –ø–ª–æ–¥–∞', correct: false },
                  { text: '34‚Äì36 –Ω–µ–¥–µ–ª—å', correct: true },
                  { text: '36+ –Ω–µ–¥–µ–ª—å –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏', correct: false },
                  { text: '–í –¥–æ–Ω–æ—à–µ–Ω–Ω–æ–º —Å—Ä–æ–∫–µ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏', correct: false }
                ]
              }
            ]
          },
          {
            title: '–≠—Ç–∞–ø 4 ‚Äî –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è —Ç–∞–∫—Ç–∏–∫–∞',
            body: '–ü–∞—Ü–∏–µ–Ω—Ç–∫–∞ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–µ—Ä—Ç–∏–ª—å–Ω–æ—Å—Ç–∏.',
            questions: [
              {
                type: 'single',
                text: '–ö–∞–∫—É—é –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Ç–∞–∫—Ç–∏–∫—É –≤—ã–±—Ä–∞—Ç—å?',
                answers: [
                  { text: '–û—Ä–≥–∞–Ω–æ—Å–æ—Ö—Ä–∞–Ω—è—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è', correct: true },
                  { text: '–ì–∏—Å—Ç–µ—Ä—ç–∫—Ç–æ–º–∏—è', correct: false },
                  { text: '–û—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ü–µ–Ω—Ç—ã in situ —Å –æ—Ç—Å—Ä–æ—á–µ–Ω–Ω–æ–π –≥–∏—Å—Ç–µ—Ä—ç–∫—Ç–æ–º–∏–µ–π', correct: false }
                ]
              }
            ]
          },
          {
            title: '–≠—Ç–∞–ø 5 ‚Äî –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –≥–µ–º–æ—Å—Ç–∞–∑',
            body: '–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≥–µ–º–æ—Å—Ç–∞–∑–∞ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤–µ—Ä–Ω—ã).',
            questions: [
              {
                type: 'multi',
                text: '–ö–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ?',
                answers: [
                  { text: '–≠–Ω–¥–æ–≤–∞—Å–∫—É–ª—è—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–∞–ª–ª–æ–Ω–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è –æ–±—â–∏—Ö –ø–æ–¥–≤–∑–¥–æ—à–Ω—ã—Ö –∞—Ä—Ç–µ—Ä–∏–π/–∞–æ—Ä—Ç—ã)', correct: true, bonusPoints: 2 },
                  { text: '–î–µ–≤–∞—Å–∫—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ç–∫–∏ (–ø–µ—Ä–µ–≤—è–∑–∫–∞ –º–∞—Ç–æ—á–Ω—ã—Ö –∞—Ä—Ç–µ—Ä–∏–π, –ø–µ—Ä–µ–≤—è–∑–∫–∞/–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è –ø–æ–¥–≤–∑–¥–æ—à–Ω—ã—Ö –∞—Ä—Ç–µ—Ä–∏–π)', correct: true },
                  { text: '–ö–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –≥–µ–º–æ—Å—Ç–∞–∑ (—Ç—É—Ä–Ω–∏–∫–µ—Ç—ã, –∫–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —à–≤—ã, –±–∞–ª–ª–æ–Ω–Ω–∞—è —Ç–∞–º–ø–æ–Ω–∞–¥–∞)', correct: true }
                ]
              }
            ]
          }
        ]
      },
      winnerThreshold: 5
    };

    // ====== –°–ï–†–í–ò–°–ù–´–ï ======
    const qs = sel => document.querySelector(sel);
    const qsa = sel => Array.from(document.querySelectorAll(sel));
    const state = {
      mode: 'landing',
      sectionId: null,
      qIndex: 0,
      answers: [],
      score: 0,
      // consilium
      sIndex: 0,
      sAnswers: [],
      sScore: 0
    };

    (function init(){
      // –ö–Ω–æ–ø–∫–∏ —à–∞–ø–∫–∏
      qs('#btnRules').addEventListener('click', ()=>toggleModal('#rulesModal', true));
      qs('#rulesClose').addEventListener('click', ()=>toggleModal('#rulesModal', false));
      qs('#rulesOk').addEventListener('click', ()=>{ if(qs('#rulesAgree').checked){qs('#btnStart').disabled=false; toggleModal('#rulesModal', false);} else {alert('–ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.');}});
      qs('#btnStart').addEventListener('click', ()=>{ selectMode('quiz'); });

      // –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
      qs('#btnPrev').addEventListener('click', prevQuestion);
      qs('#btnNext').addEventListener('click', nextQuestion);

      // –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫–æ–Ω—Å–∏–ª–∏—É–º–∞
      qs('#btnPrevS').addEventListener('click', prevStage);
      qs('#btnNextS').addEventListener('click', nextStage);

      // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ç–æ—á–∫–∏
      updateStageDots();
    })();

    function toggleModal(sel, on){
      const m = qs(sel);
      m.style.display = on ? 'flex' : 'none';
    }

    function selectMode(mode){
      state.mode = mode;
      qs('#landing').style.display = (mode==='landing')?'grid':'none';
      qs('#quiz').style.display    = (mode==='quiz')   ?'block':'none';
      qs('#result').style.display  = 'none';
      qs('#consilium').style.display = (mode==='consilium')?'block':'none';

      if(mode==='quiz'){
        if(!state.sectionId){ state.sectionId = CONFIG.sections[0]?.id; }
        startQuiz();
      }
      if(mode==='consilium'){
        state.sIndex = 0;
        state.sAnswers = [];
        state.sScore = 0;
        renderStage();
      }
    }

    function selectSection(id){
      state.sectionId = id;
      selectMode('quiz');
    }

    // ====== –í–ò–ö–¢–û–†–ò–ù–ê ======
    function getSection(){
      return CONFIG.sections.find(s=>s.id===state.sectionId) || CONFIG.sections[0];
    }

    function startQuiz(){
      state.qIndex = 0; state.answers = []; state.score = 0;
      const sec = getSection();
      qs('#sectionTitle').textContent = sec.title;
      qs('#qTotal').textContent = String(sec.questions.length);
      renderQuestion();
      updateProgress();
    }

    function renderQuestion(){
      const sec = getSection();
      const q = sec.questions[state.qIndex];
      if(!q){ return; }

      qs('#qIndex').textContent = String(state.qIndex+1);

      const wrap = document.createElement('div');
      wrap.innerHTML = `
        <h3>${escapeHtml(q.text)}</h3>
        <div class="hint">${q.type==='multi'?'–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤':'–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç'}</div>
      `;

      q.answers.forEach((ans, i)=>{
        const id = `q${state.qIndex}_a${i}`;
        const answerEl = document.createElement('label');
        answerEl.className = 'answer';
        answerEl.setAttribute('for', id);
        answerEl.innerHTML = `
          <input id="${id}" name="q${state.qIndex}" type="${q.type==='multi'?'checkbox':'radio'}" value="${i}">
          <span class="opt-label">${escapeHtml(ans.text)}</span>
        `;
        wrap.appendChild(answerEl);
      });

      const holder = qs('#question');
      holder.innerHTML = '';
      holder.appendChild(wrap);

      qs('#btnPrev').disabled = state.qIndex===0;
      qs('#btnNext').textContent = state.qIndex===getSection().questions.length-1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å' : '–î–∞–ª–µ–µ';
    }

    function collectAnswer(){
      const sec = getSection();
      const q = sec.questions[state.qIndex];
      const inputs = qsa(`#question input[name="q${state.qIndex}"]`);
      let selectedIdxs = inputs.filter(i=>i.checked).map(i=>Number(i.value));
      if(q.type==='single' && selectedIdxs.length===0){ alert('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç'); return null; }
      if(q.type==='multi' && selectedIdxs.length===0){ alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç'); return null; }

      const correctIdxs = q.answers.map((a,idx)=>a.correct?idx:null).filter(v=>v!==null);
      let score=0, correct=false;
      if(q.type==='single'){
        correct = selectedIdxs.length===1 && correctIdxs.includes(selectedIdxs[0]);
        score = correct ? 1 : 0;
      } else {
        const isExact = arraysEqual(new Set(selectedIdxs), new Set(correctIdxs));
        if(isExact){ score = 1; correct = true; }
        else {
          const inter = selectedIdxs.filter(i=>correctIdxs.includes(i)).length;
          score = Math.min(1, inter * 0.5);
          correct = false;
        }
      }

      state.answers[state.qIndex] = { user: selectedIdxs, correct, score };
      return {correct, score};
    }

    function nextQuestion(){
      const res = collectAnswer();
      if(!res) return;

      const sec = getSection();
      if(state.qIndex < sec.questions.length-1){
        state.qIndex++;
        renderQuestion();
        updateProgress();
      } else {
        finishQuiz();
      }
    }

    function prevQuestion(){
      if(state.qIndex>0){
        state.qIndex--;
        renderQuestion();
        updateProgress();
      }
    }

    function updateProgress(){
      const sec = getSection();
      const p = ((state.qIndex) / (sec.questions.length-1));
      const pct = Math.max(0, Math.min(1, isFinite(p)?p:0));
      qs('#progressBar').style.width = (pct*100)+'%';
    }

    function finishQuiz(){
      const sec = getSection();
      let total = 0;
      state.answers.forEach(a=>{ if(a) total += a.score||0; });
      state.score = +total.toFixed(2);

      qs('#quiz').style.display='none';
      const res = qs('#result');
      qs('#scoreBadge').textContent = String(state.score);
      const win = state.score >= CONFIG.winnerThreshold;
      qs('#winner').style.display = win ? 'inline-block' : 'none';

      const review = qs('#review');
      review.innerHTML = '';
      sec.questions.forEach((q, qi)=>{
        const a = state.answers[qi];
        const row = document.createElement('div');
        row.className = 'card';
        row.style.margin='10px 0';
        row.innerHTML = `
          <div style='display:flex;justify-content:space-between;gap:8px;align-items:center'>
            <div style='font-weight:700'>–í–æ–ø—Ä–æ—Å ${qi+1}:</div>
            <span class='badge ${a?.correct?'ok':'bad'}'>${a?.score ?? 0} –±–∞–ª–ª(–æ–≤)</span>
          </div>
          <div style='margin-top:6px'>${escapeHtml(q.text)}</div>
          <div style='margin-top:8px'>
            <div class='hint'>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç–º–µ—á–µ–Ω—ã ‚úì</div>
            ${q.answers.map((opt,oi)=>{
              const isUser = a?.user?.includes(oi);
              const isRight = !!opt.correct;
              return `<div style="display:flex;gap:8px;align-items:center;margin:4px 0">
                        <span style="width:22px;height:22px;display:inline-grid;place-items:center;border-radius:8px;border:1px solid #eee">${isRight?'‚úì':(isUser?'‚Ä¢':'')}</span>
                        <span>${escapeHtml(opt.text)}</span>
                      </div>`;
            }).join('')}
          </div>
        `;
        review.appendChild(row);
      });

      res.style.display='block';
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function restart(){
      state.sectionId = null; state.qIndex=0; state.answers=[]; state.score=0; state.mode='landing';
      selectMode('landing');
    }

    // ====== –ö–û–ù–°–ò–õ–ò–£–ú ======
    function updateStageDots(){
      const dots = CONFIG.consilium.stages.map((_,i)=>`<span class="${i===state.sIndex?'on':''}"></span>`).join('');
      qs('#stageDots').innerHTML = dots;
    }

    function renderStage(){
      updateStageDots();
      const s = CONFIG.consilium.stages[state.sIndex];
      const holder = qs('#stage');
      holder.innerHTML = '';
      const box = document.createElement('div');
      box.innerHTML = `
        <h4 style="margin:0 0 8px 0">${escapeHtml(s.title||('–≠—Ç–∞–ø '+(state.sIndex+1)))}</h4>
        ${s.body? `<p>${escapeHtml(s.body)}</p>`:''}
      `;
      const questions = s.questions || (s.question ? [s.question] : []);
      questions.forEach((q, qi)=>{
        const qBox = document.createElement('div');
        qBox.className='card';
        const hint = q.type==='multi' ? '–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤' : '–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç';
        qBox.innerHTML = `<div style='font-weight:600;margin-bottom:6px'>${escapeHtml(q.text || ('–í–æ–ø—Ä–æ—Å '+(qi+1)))}</div><div class='hint' style='margin-bottom:8px'>${hint}</div>`;
        q.answers.forEach((opt, ai)=>{
          const id = `s${state.sIndex}_q${qi}_a${ai}`;
          const name = `s${state.sIndex}_q${qi}`;
          const label = document.createElement('label');
          label.className = 'answer';
          label.setAttribute('for', id);
          label.innerHTML = `
            <input id="${id}" name="${name}" type="${q.type==='multi'?'checkbox':'radio'}" value="${ai}">
            <span class="opt-label">${escapeHtml(opt.text)}</span>
          `;
          qBox.appendChild(label);
        });
        box.appendChild(qBox);
      });
      holder.appendChild(box);
      qs('#btnPrevS').disabled = state.sIndex===0;
      qs('#btnNextS').textContent = state.sIndex===CONFIG.consilium.stages.length-1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å' : '–î–∞–ª–µ–µ';
    }

    function collectStageAnswers(){
      const s = CONFIG.consilium.stages[state.sIndex];
      const questions = s.questions || (s.question ? [s.question] : []);
      let stageScore = 0;
      const stageAnswers = [];
      for(let qi=0; qi<questions.length; qi++){
        const q = questions[qi];
        const inputs = qsa(`#stage input[name="s${state.sIndex}_q${qi}"]`);
        const picked = inputs.filter(i=>i.checked).map(i=>Number(i.value));
        if(picked.length===0){
          alert('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç(—ã) –¥–ª—è –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —ç—Ç–∞–ø–∞.');
          return null;
        }
        let qScore = 0;
        if(q.type==='single'){
          const idx = picked[0];
          if(q.answers[idx]?.correct){ qScore += 1; }
          if(q.answers[idx]?.bonusPoints){ qScore += Number(q.answers[idx].bonusPoints)||0; }
        } else { // multi
          picked.forEach(idx=>{
            if(q.answers[idx]?.correct){ qScore += 1; }
            if(q.answers[idx]?.bonusPoints){ qScore += Number(q.answers[idx].bonusPoints)||0; }
          });
        }
        stageScore += qScore;
        stageAnswers.push({ user: picked, score: qScore });
      }
      state.sAnswers[state.sIndex] = { answers: stageAnswers, stageScore };
      return stageScore;
    }

    function finishConsilium(){
      let total = 0;
      state.sAnswers.forEach(s => { if(s) total += s.stageScore||0; });
      state.sScore = +total.toFixed(2);
      qs('#landing').style.display='none';
      qs('#quiz').style.display='none';
      qs('#consilium').style.display='none';
      const res = qs('#result');
      qs('#scoreBadge').textContent = String(state.sScore);
      const win = state.sScore >= CONFIG.winnerThreshold;
      qs('#winner').style.display = win ? 'inline-block' : 'none';
      res.querySelector('h3').textContent = '–†–µ–∑—É–ª—å—Ç–∞—Ç (–ö–æ–Ω—Å–∏–ª–∏—É–º)';
      const review = qs('#review');
      review.innerHTML = '';
      CONFIG.consilium.stages.forEach((stage, si)=>{
        const sA = state.sAnswers[si];
        const row = document.createElement('div');
        row.className = 'card';
        row.style.margin='10px 0';
        const sScore = sA?.stageScore || 0;
        row.innerHTML = `
          <div style='display:flex;justify-content:space-between;gap:8px;align-items:center'>
            <div style='font-weight:700'>${escapeHtml(stage.title||('–≠—Ç–∞–ø '+(si+1)))}</div>
            <span class='badge ${sScore>0?'ok':'bad'}'>${sScore} –±–∞–ª–ª(–æ–≤)</span>
          </div>
          ${stage.body? `<div style='margin-top:6px' class='hint'>${escapeHtml(stage.body)}</div>`:''}
        `;
        const questions = stage.questions || (stage.question ? [stage.question] : []);
        questions.forEach((q, qi)=>{
          const qa = sA?.answers?.[qi];
          const blk = document.createElement('div');
          blk.style.margin = '8px 0';
          blk.innerHTML = `<div style='font-weight:600;margin:4px 0'>${escapeHtml(q.text||('–í–æ–ø—Ä–æ—Å '+(qi+1)))}</div>` +
            q.answers.map((opt, oi)=>{
              const isUser = qa?.user?.includes(oi);
              const isRight = !!opt.correct;
              return `<div style="display:flex;gap:8px;align-items:center;margin:3px 0">
                        <span style="width:22px;height:22px;display:inline-grid;place-items:center;border-radius:8px;border:1px solid #eee">${isRight?'‚úì':(isUser?'‚Ä¢':'')}</span>
                        <span>${escapeHtml(opt.text)}</span>
                      </div>`;
            }).join('');
          row.appendChild(blk);
        });
        review.appendChild(row);
      });
      res.style.display='block';
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function nextStage(){
      const scored = collectStageAnswers();
      if(scored===null) return;
      if(state.sIndex < CONFIG.consilium.stages.length-1){
        state.sIndex++;
        renderStage();
      } else {
        finishConsilium();
      }
    }
    function prevStage(){ if(state.sIndex>0){ state.sIndex--; renderStage(); } }

    // ====== –£–¢–ò–õ–´ ======
    function arraysEqual(a,b){ if(a.size!==b.size) return false; for(const v of a){ if(!b.has(v)) return false; } return true; }
    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])); }
  </script>
</body>
</html>
